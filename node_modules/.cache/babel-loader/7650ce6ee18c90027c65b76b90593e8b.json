{"ast":null,"code":"var _jsxFileName = \"/home/mronoyy/Documents/project/react-dashboard/src/views/Products/Products.js\";\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport MaterialTable from \"material-table\";\nimport { CategoryContext } from \"../../context/categoryContext\";\nimport axios from \"axios\";\nimport LoadingOverlay from \"react-loading-overlay\";\nimport Swal from \"sweetalert2\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    padding: theme.spacing(0.5)\n  },\n  content: {\n    marginTop: theme.spacing(0)\n  }\n}));\nexport default function Categeory() {\n  const classes = useStyles();\n  const [categoryContext, setCategoryContext] = useContext(CategoryContext);\n  const [dataProduct, setDataProduct] = useState([]);\n  var obj = categoryContext.reduce(function (acc, cur, i) {\n    acc[cur._id] = cur.name;\n    return acc;\n  }, {});\n  const [loading, setLoading] = useState({\n    get: false,\n    add: false,\n    update: false,\n    delete: false\n  });\n  const [imagesUrl, setImageUrl] = useState(\"\");\n\n  const onImageChange = e => {\n    setImageUrl(e.target.files[0]);\n  };\n\n  const [state, setState] = React.useState({\n    columns: [{\n      title: \"Name\",\n      field: \"name\"\n    }, {\n      title: \"Price\",\n      field: \"price\"\n    }, {\n      title: \"Stock\",\n      field: \"stock\"\n    }, {\n      title: \"Description\",\n      field: \"description\"\n    }, {\n      title: \"Image\",\n      field: \"imageUrl\",\n      editComponent: () => /*#__PURE__*/React.createElement(\"input\", {\n        type: \"file\",\n        name: \"imageUrl\",\n        onChange: onImageChange,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 49,\n          columnNumber: 11\n        }\n      })\n    }, {\n      title: \"Category\",\n      field: \"categoryId\",\n      lookup: obj\n    }],\n    data: [{\n      name_product: \"Daun\",\n      slug: \"Baran\",\n      price: \"Rp. 80.000\",\n      stock: \"sss\",\n      description: \"ddd\",\n      status: \"sac\",\n      imageUrl: \"laks\",\n      categoryId: \"uuuu\"\n    }, {\n      name_product: \"Daun\",\n      slug: \"Baran\",\n      price: \"Rp. 100.000\",\n      stock: \"sss\",\n      description: \"ddd\",\n      status: \"sac\",\n      imageUrl: \"laks\",\n      categoryId: \"uuuu\"\n    }, {\n      name_product: \"Daun\",\n      slug: \"Baran\",\n      price: \"Rp. 95.000\",\n      stock: \"sss\",\n      description: \"ddd\",\n      status: \"sac\",\n      imageUrl: \"laks\",\n      categoryId: \"uuuu\"\n    }, {\n      name_product: \"Daun\",\n      slug: \"Baran\",\n      price: \"Rp. 100.000\",\n      stock: \"sss\",\n      description: \"ddd\",\n      status: \"sac\",\n      imageUrl: \"laks\",\n      categoryId: \"uuuu\"\n    }]\n  });\n  useEffect(() => {\n    handleGetProduct();\n  }, []);\n\n  const handleGetProduct = () => {\n    setLoading(loading => ({ ...loading,\n      get: true\n    }));\n    axios({\n      method: \"get\",\n      url: `${process.env.REACT_APP_API_DASH + \"/product\"}`,\n      headers: {\n        Authorization: \"Bearer \" + localStorage.getItem(\"token\")\n      }\n    }).then(res => {\n      console.log(\"coba\", res.data.products);\n      setDataProduct(res.data.products);\n      setLoading(loading => ({ ...loading,\n        get: false\n      }));\n    }).catch(err => {\n      setLoading(loading => ({ ...loading,\n        get: false\n      }));\n      Swal.fire({\n        icon: \"error\",\n        title: \"Check your connections\",\n        text: \"\"\n      });\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(LoadingOverlay, {\n    active: loading.get || loading.add || loading.update || loading.delete === true ? true : false,\n    spinner: true,\n    text: loading.get ? \"loading your data...\" : loading.add ? \"add data...\" : loading.update ? \"update data...\" : loading.delete ? \"delete data...\" : null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.root,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(MaterialTable, {\n    className: classes.content,\n    title: \"Products\",\n    columns: state.columns,\n    data: dataProduct.map(({\n      categoryId,\n      ...rest\n    }) => {\n      return { ...rest,\n        categoryId: categoryId._id,\n        categoryName: categoryId.name\n      };\n    }),\n    editable: {\n      onRowAdd: newData => new Promise(resolve => {\n        setLoading(loading => ({ ...loading,\n          add: true\n        }));\n        resolve();\n        setState(prevState => {\n          const formData = new FormData();\n          formData.append(\"image\", imagesUrl);\n          formData.append(\"name\", newData.name);\n          formData.append(\"price\", newData.price);\n          formData.append(\"stock\", newData.stock);\n          formData.append(\"description\", newData.description);\n          formData.append(\"categoryId\", newData.categoryId);\n          const data = [...prevState.data];\n          console.log(\"form adata\", formData);\n          axios({\n            method: \"post\",\n            url: `${process.env.REACT_APP_API_DASH + \"/product\"}`,\n            headers: {\n              Authorization: \"Bearer \" + localStorage.getItem(\"token\")\n            },\n            data: formData\n          }).then(res => {\n            console.log(\"tambah\", res);\n            Swal.fire(\"Added Success\", \"\", \"success\");\n            handleGetProduct();\n            setLoading(loading => ({ ...loading,\n              add: false\n            }));\n          }).catch(err => {\n            setLoading(loading => ({ ...loading,\n              add: false\n            }));\n            Swal.fire({\n              icon: \"error\",\n              title: \"Check your connections\",\n              text: \"\"\n            });\n          });\n          return { ...prevState,\n            data\n          };\n        });\n      }),\n      onRowUpdate: (newData, oldData) => new Promise(resolve => {\n        setLoading(loading => ({ ...loading,\n          update: true\n        }));\n        setTimeout(() => {\n          resolve();\n\n          if (oldData) {\n            setState(prevState => {\n              const data = [...prevState.data];\n              axios({\n                method: \"put\",\n                url: `${process.env.REACT_APP_API_DASH + \"/product\"}`,\n                headers: {\n                  Authorization: \"Bearer \" + localStorage.getItem(\"token\")\n                },\n                data: {\n                  name: newData.name,\n                  price: newData.price,\n                  stock: newData.stock,\n                  description: newData.description,\n                  imgUrl: newData.imgUrl,\n                  categoryId: newData.categoryId,\n                  id: newData._id\n                }\n              }).then(res => {\n                Swal.fire(\"Update Success\", \"\", \"success\");\n                handleGetProduct();\n                setLoading(loading => ({ ...loading,\n                  update: false\n                }));\n              }).catch(err => {\n                setLoading(loading => ({ ...loading,\n                  update: false\n                }));\n                Swal.fire({\n                  icon: \"error\",\n                  title: \"Check your connections\",\n                  text: \"\"\n                });\n              });\n              return { ...prevState,\n                data\n              };\n            });\n          }\n        }, 600);\n      }),\n      onRowDelete: oldData => new Promise(resolve => {\n        setLoading(loading => ({ ...loading,\n          delete: true\n        }));\n        setTimeout(() => {\n          resolve();\n          setState(prevState => {\n            const data = [...prevState.data];\n            axios({\n              method: \"delete\",\n              url: `${process.env.REACT_APP_API_DASH + `${\"/product/\" + oldData._id}`}`,\n              headers: {\n                Authorization: \"Bearer \" + localStorage.getItem(\"token\")\n              },\n              data: oldData\n            }).then(res => {\n              Swal.fire(\"Delete Success\", \"\", \"success\");\n              handleGetProduct();\n              setLoading(loading => ({ ...loading,\n                delete: false\n              }));\n            }).catch(err => {\n              setLoading(loading => ({ ...loading,\n                delete: false\n              }));\n              Swal.fire({\n                icon: \"error\",\n                title: \"Check your connections\",\n                text: \"\"\n              });\n            });\n            return { ...prevState,\n              data\n            };\n          });\n        }, 600);\n      })\n    },\n    options: {\n      headerStyle: {\n        fontSize: \"15px\",\n        fontWeight: \"bold\",\n        borderRight: \"1px solid #fff\",\n        background: \"#358A7C\",\n        color: \"#fff\"\n      },\n      rowStyle: {\n        fontFamily: \"Roboto,Helvetica,Arial,sans-serif\"\n      },\n      exportButton: true\n    },\n    detailPanel: rowData => {\n      return /*#__PURE__*/React.createElement(\"img\", {\n        style: {\n          width: \"25%\",\n          height: \"250px\",\n          display: \"block\",\n          marginLeft: \"auto\",\n          marginRight: \"auto\",\n          marginTop: \"10px\",\n          marginBottom: \"10px\"\n        },\n        src: rowData.imageUrl === \"No picture\" ? \"https://www.thermaxglobal.com/wp-content/uploads/2020/05/image-not-found.jpg\" : `http://dashmanage.herokuapp.com/${rowData.imageUrl}`,\n        alt: \"products\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 15\n        }\n      });\n    },\n    onRowClick: (event, rowData, togglePanel) => togglePanel(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 9\n    }\n  })));\n}","map":{"version":3,"sources":["/home/mronoyy/Documents/project/react-dashboard/src/views/Products/Products.js"],"names":["React","useState","useEffect","useContext","makeStyles","MaterialTable","CategoryContext","axios","LoadingOverlay","Swal","useStyles","theme","root","padding","spacing","content","marginTop","Categeory","classes","categoryContext","setCategoryContext","dataProduct","setDataProduct","obj","reduce","acc","cur","i","_id","name","loading","setLoading","get","add","update","delete","imagesUrl","setImageUrl","onImageChange","e","target","files","state","setState","columns","title","field","editComponent","lookup","data","name_product","slug","price","stock","description","status","imageUrl","categoryId","handleGetProduct","method","url","process","env","REACT_APP_API_DASH","headers","Authorization","localStorage","getItem","then","res","console","log","products","catch","err","fire","icon","text","map","rest","categoryName","onRowAdd","newData","Promise","resolve","prevState","formData","FormData","append","onRowUpdate","oldData","setTimeout","imgUrl","id","onRowDelete","headerStyle","fontSize","fontWeight","borderRight","background","color","rowStyle","fontFamily","exportButton","rowData","width","height","display","marginLeft","marginRight","marginBottom","event","togglePanel"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport MaterialTable from \"material-table\";\nimport { CategoryContext } from \"../../context/categoryContext\";\nimport axios from \"axios\";\nimport LoadingOverlay from \"react-loading-overlay\";\nimport Swal from \"sweetalert2\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    padding: theme.spacing(0.5),\n  },\n  content: {\n    marginTop: theme.spacing(0),\n  },\n}));\n\nexport default function Categeory() {\n  const classes = useStyles();\n  const [categoryContext, setCategoryContext] = useContext(CategoryContext);\n  const [dataProduct, setDataProduct] = useState([]);\n\n  var obj = categoryContext.reduce(function(acc, cur, i) {\n    acc[cur._id] = cur.name;\n    return acc;\n  }, {});\n\n  const [loading, setLoading] = useState({\n    get: false,\n    add: false,\n    update: false,\n    delete: false,\n  });\n  const [imagesUrl, setImageUrl] = useState(\"\");\n  const onImageChange = (e) => {\n    setImageUrl(e.target.files[0]);\n  };\n\n  const [state, setState] = React.useState({\n    columns: [\n      { title: \"Name\", field: \"name\" },\n      { title: \"Price\", field: \"price\" },\n      { title: \"Stock\", field: \"stock\" },\n      { title: \"Description\", field: \"description\" },\n      {\n        title: \"Image\",\n        field: \"imageUrl\",\n        editComponent: () => (\n          <input type=\"file\" name=\"imageUrl\" onChange={onImageChange} />\n        ),\n      },\n      {\n        title: \"Category\",\n        field: \"categoryId\",\n        lookup: obj,\n      },\n    ],\n    data: [\n      {\n        name_product: \"Daun\",\n        slug: \"Baran\",\n        price: \"Rp. 80.000\",\n        stock: \"sss\",\n        description: \"ddd\",\n        status: \"sac\",\n        imageUrl: \"laks\",\n        categoryId: \"uuuu\",\n      },\n      {\n        name_product: \"Daun\",\n        slug: \"Baran\",\n        price: \"Rp. 100.000\",\n        stock: \"sss\",\n        description: \"ddd\",\n        status: \"sac\",\n        imageUrl: \"laks\",\n        categoryId: \"uuuu\",\n      },\n      {\n        name_product: \"Daun\",\n        slug: \"Baran\",\n        price: \"Rp. 95.000\",\n        stock: \"sss\",\n        description: \"ddd\",\n        status: \"sac\",\n        imageUrl: \"laks\",\n        categoryId: \"uuuu\",\n      },\n      {\n        name_product: \"Daun\",\n        slug: \"Baran\",\n        price: \"Rp. 100.000\",\n        stock: \"sss\",\n        description: \"ddd\",\n        status: \"sac\",\n        imageUrl: \"laks\",\n        categoryId: \"uuuu\",\n      },\n    ],\n  });\n\n  useEffect(() => {\n    handleGetProduct();\n  }, []);\n\n  const handleGetProduct = () => {\n    setLoading((loading) => ({\n      ...loading,\n      get: true,\n    }));\n    axios({\n      method: \"get\",\n      url: `${process.env.REACT_APP_API_DASH + \"/product\"}`,\n      headers: {\n        Authorization: \"Bearer \" + localStorage.getItem(\"token\"),\n      },\n    })\n      .then((res) => {\n        console.log(\"coba\", res.data.products);\n        setDataProduct(res.data.products);\n        setLoading((loading) => ({\n          ...loading,\n          get: false,\n        }));\n      })\n      .catch((err) => {\n        setLoading((loading) => ({\n          ...loading,\n          get: false,\n        }));\n        Swal.fire({\n          icon: \"error\",\n          title: \"Check your connections\",\n          text: \"\",\n        });\n      });\n  };\n\n  return (\n    <LoadingOverlay\n      active={\n        loading.get || loading.add || loading.update || loading.delete === true\n          ? true\n          : false\n      }\n      spinner\n      text={\n        loading.get\n          ? \"loading your data...\"\n          : loading.add\n          ? \"add data...\"\n          : loading.update\n          ? \"update data...\"\n          : loading.delete\n          ? \"delete data...\"\n          : null\n      }\n    >\n      <div className={classes.root}>\n        <MaterialTable\n          className={classes.content}\n          title=\"Products\"\n          columns={state.columns}\n          data={dataProduct.map(({ categoryId, ...rest }) => {\n            return {\n              ...rest,\n              categoryId: categoryId._id,\n              categoryName: categoryId.name,\n            };\n          })}\n          editable={{\n            onRowAdd: (newData) =>\n              new Promise((resolve) => {\n                setLoading((loading) => ({\n                  ...loading,\n                  add: true,\n                }));\n                resolve();\n                setState((prevState) => {\n                  const formData = new FormData();\n                  formData.append(\"image\", imagesUrl);\n                  formData.append(\"name\", newData.name);\n                  formData.append(\"price\", newData.price);\n                  formData.append(\"stock\", newData.stock);\n                  formData.append(\"description\", newData.description);\n                  formData.append(\"categoryId\", newData.categoryId);\n                  const data = [...prevState.data];\n                  console.log(\"form adata\", formData);\n                  axios({\n                    method: \"post\",\n                    url: `${process.env.REACT_APP_API_DASH + \"/product\"}`,\n                    headers: {\n                      Authorization: \"Bearer \" + localStorage.getItem(\"token\"),\n                    },\n                    data: formData,\n                  })\n                    .then((res) => {\n                      console.log(\"tambah\", res);\n                      Swal.fire(\"Added Success\", \"\", \"success\");\n                      handleGetProduct();\n                      setLoading((loading) => ({\n                        ...loading,\n                        add: false,\n                      }));\n                    })\n                    .catch((err) => {\n                      setLoading((loading) => ({\n                        ...loading,\n                        add: false,\n                      }));\n                      Swal.fire({\n                        icon: \"error\",\n                        title: \"Check your connections\",\n                        text: \"\",\n                      });\n                    });\n                  return { ...prevState, data };\n                });\n              }),\n            onRowUpdate: (newData, oldData) =>\n              new Promise((resolve) => {\n                setLoading((loading) => ({\n                  ...loading,\n                  update: true,\n                }));\n                setTimeout(() => {\n                  resolve();\n                  if (oldData) {\n                    setState((prevState) => {\n                      const data = [...prevState.data];\n                      axios({\n                        method: \"put\",\n                        url: `${process.env.REACT_APP_API_DASH + \"/product\"}`,\n                        headers: {\n                          Authorization:\n                            \"Bearer \" + localStorage.getItem(\"token\"),\n                        },\n                        data: {\n                          name: newData.name,\n                          price: newData.price,\n                          stock: newData.stock,\n                          description: newData.description,\n                          imgUrl: newData.imgUrl,\n                          categoryId: newData.categoryId,\n                          id: newData._id,\n                        },\n                      })\n                        .then((res) => {\n                          Swal.fire(\"Update Success\", \"\", \"success\");\n                          handleGetProduct();\n                          setLoading((loading) => ({\n                            ...loading,\n                            update: false,\n                          }));\n                        })\n                        .catch((err) => {\n                          setLoading((loading) => ({\n                            ...loading,\n                            update: false,\n                          }));\n                          Swal.fire({\n                            icon: \"error\",\n                            title: \"Check your connections\",\n                            text: \"\",\n                          });\n                        });\n                      return { ...prevState, data };\n                    });\n                  }\n                }, 600);\n              }),\n            onRowDelete: (oldData) =>\n              new Promise((resolve) => {\n                setLoading((loading) => ({\n                  ...loading,\n                  delete: true,\n                }));\n                setTimeout(() => {\n                  resolve();\n                  setState((prevState) => {\n                    const data = [...prevState.data];\n                    axios({\n                      method: \"delete\",\n                      url: `${process.env.REACT_APP_API_DASH + `${\"/product/\" + oldData._id}`}`,\n                      headers: {\n                        Authorization:\n                          \"Bearer \" + localStorage.getItem(\"token\"),\n                      },\n                      data: oldData,\n                    })\n                      .then((res) => {\n                        Swal.fire(\"Delete Success\", \"\", \"success\");\n                        handleGetProduct();\n                        setLoading((loading) => ({\n                          ...loading,\n                          delete: false,\n                        }));\n                      })\n                      .catch((err) => {\n                        setLoading((loading) => ({\n                          ...loading,\n                          delete: false,\n                        }));\n                        Swal.fire({\n                          icon: \"error\",\n                          title: \"Check your connections\",\n                          text: \"\",\n                        });\n                      });\n                    return { ...prevState, data };\n                  });\n                }, 600);\n              }),\n          }}\n          options={{\n            headerStyle: {\n              fontSize: \"15px\",\n              fontWeight: \"bold\",\n              borderRight: \"1px solid #fff\",\n              background: \"#358A7C\",\n              color: \"#fff\",\n            },\n            rowStyle: {\n              fontFamily: \"Roboto,Helvetica,Arial,sans-serif\",\n            },\n            exportButton: true,\n          }}\n          detailPanel={(rowData) => {\n            return (\n              <img\n                style={{\n                  width: \"25%\",\n                  height: \"250px\",\n                  display: \"block\",\n                  marginLeft: \"auto\",\n                  marginRight: \"auto\",\n                  marginTop: \"10px\",\n                  marginBottom: \"10px\",\n                }}\n                src={\n                  rowData.imageUrl === \"No picture\"\n                    ? \"https://www.thermaxglobal.com/wp-content/uploads/2020/05/image-not-found.jpg\"\n                    : `http://dashmanage.herokuapp.com/${rowData.imageUrl}`\n                }\n                alt=\"products\"\n              />\n            );\n          }}\n          onRowClick={(event, rowData, togglePanel) => togglePanel()}\n        />\n      </div>\n    </LoadingOverlay>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}