{"ast":null,"code":"import _objectWithoutProperties from \"/home/dimas/git/react-dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"/home/dimas/git/react-dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/home/dimas/git/react-dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/dimas/git/react-dashboard/src/views/Products/Products.js\";\nimport React, { useState, useEffect, useContext } from \"react\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport MaterialTable from \"material-table\";\nimport { CategoryContext } from \"../../context/categoryContext\";\nimport axios from \"axios\";\nimport { apiDashManage } from \"../../api/api\";\nimport LoadingOverlay from \"react-loading-overlay\";\nimport Swal from \"sweetalert2\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    padding: theme.spacing(0.5)\n  },\n  content: {\n    marginTop: theme.spacing(0)\n  }\n}));\nexport default function Categeory() {\n  const classes = useStyles();\n\n  const _useContext = useContext(CategoryContext),\n        _useContext2 = _slicedToArray(_useContext, 2),\n        categoryContext = _useContext2[0],\n        setCategoryContext = _useContext2[1];\n\n  const _useState = useState([]),\n        _useState2 = _slicedToArray(_useState, 2),\n        dataCategory = _useState2[0],\n        setDataCategory = _useState2[1];\n\n  const _useState3 = useState([]),\n        _useState4 = _slicedToArray(_useState3, 2),\n        dataProduct = _useState4[0],\n        setDataProduct = _useState4[1];\n\n  const _useState5 = useState(null),\n        _useState6 = _slicedToArray(_useState5, 2),\n        id = _useState6[0],\n        setId = _useState6[1];\n\n  var obj = categoryContext.reduce(function (acc, cur, i) {\n    acc[cur._id] = cur.name;\n    return acc;\n  }, {});\n\n  const _useState7 = useState({\n    get: false,\n    add: false,\n    update: false,\n    delete: false\n  }),\n        _useState8 = _slicedToArray(_useState7, 2),\n        loading = _useState8[0],\n        setLoading = _useState8[1];\n\n  const _React$useState = React.useState({\n    columns: [{\n      title: \"Name\",\n      field: \"name\"\n    }, {\n      title: \"Price\",\n      field: \"price\"\n    }, {\n      title: \"Stock\",\n      field: \"stock\"\n    }, {\n      title: \"Description\",\n      field: \"description\"\n    }, {\n      title: \"Image\",\n      field: \"imageUrl\"\n    }, {\n      title: \"Category\",\n      field: \"categoryId\",\n      lookup: obj\n    }],\n    data: [{\n      name_product: \"Daun\",\n      slug: \"Baran\",\n      price: \"Rp. 80.000\",\n      stock: \"sss\",\n      description: \"ddd\",\n      status: \"sac\",\n      imageUrl: \"laks\",\n      categoryId: \"uuuu\"\n    }, {\n      name_product: \"Daun\",\n      slug: \"Baran\",\n      price: \"Rp. 100.000\",\n      stock: \"sss\",\n      description: \"ddd\",\n      status: \"sac\",\n      imageUrl: \"laks\",\n      categoryId: \"uuuu\"\n    }, {\n      name_product: \"Daun\",\n      slug: \"Baran\",\n      price: \"Rp. 95.000\",\n      stock: \"sss\",\n      description: \"ddd\",\n      status: \"sac\",\n      imageUrl: \"laks\",\n      categoryId: \"uuuu\"\n    }, {\n      name_product: \"Daun\",\n      slug: \"Baran\",\n      price: \"Rp. 100.000\",\n      stock: \"sss\",\n      description: \"ddd\",\n      status: \"sac\",\n      imageUrl: \"laks\",\n      categoryId: \"uuuu\"\n    }]\n  }),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        state = _React$useState2[0],\n        setState = _React$useState2[1];\n\n  useEffect(() => {\n    handleGetCategory();\n    handleGetProduct();\n  }, []);\n  useEffect(() => {\n    console.log(\"data categ\", dataCategory);\n  }, [dataCategory]);\n\n  const handleGetCategory = () => {\n    setFormState(loading => _objectSpread({}, loading, {\n      get: true\n    }));\n    axios({\n      method: \"get\",\n      url: \"\".concat(apiDashManage + \"category\"),\n      headers: {\n        Authorization: \"Bearer \" + localStorage.getItem(\"token\")\n      }\n    }).then(res => {\n      console.log(\"respon get category\", res.data.categories);\n      setDataCategory(res.data.categories);\n      setFormState(loading => _objectSpread({}, loading, {\n        get: false\n      }));\n    });\n  };\n\n  const handleGetProduct = () => {\n    axios({\n      method: \"get\",\n      url: \"\".concat(apiDashManage + \"product\"),\n      headers: {\n        Authorization: \"Bearer \" + localStorage.getItem(\"token\")\n      }\n    }).then(res => {\n      setDataProduct(res.data.products);\n    });\n  };\n\n  return React.createElement(LoadingOverlay, {\n    active: loading.get,\n    spinner: true,\n    text: \"loading your data...\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: classes.root,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, React.createElement(MaterialTable, {\n    className: classes.content,\n    title: \"Products\",\n    columns: state.columns,\n    data: dataProduct.map((_ref) => {\n      let categoryId = _ref.categoryId,\n          rest = _objectWithoutProperties(_ref, [\"categoryId\"]);\n\n      return _objectSpread({}, rest, {\n        categoryId: categoryId._id,\n        categoryName: categoryId.name\n      });\n    }),\n    editable: {\n      onRowAdd: newData => new Promise(resolve => {\n        setTimeout(() => {\n          resolve();\n          setState(prevState => {\n            const data = [...prevState.data];\n            axios({\n              method: \"post\",\n              url: \"\".concat(apiDashManage + \"product\"),\n              headers: {\n                Authorization: \"Bearer \" + localStorage.getItem(\"token\")\n              },\n              data: newData\n            }).then(res => {\n              console.log(\"ADD DATA\", res);\n              Swal.fire(\"Added Success\", \"\", \"success\"); // setLoading(loading.add(false));\n\n              handleGetProduct();\n            });\n            return _objectSpread({}, prevState, {\n              data\n            });\n          });\n        }, 600);\n      }),\n      onRowUpdate: (newData, oldData) => new Promise(resolve => {\n        setTimeout(() => {\n          resolve();\n\n          if (oldData) {\n            setState(prevState => {\n              const data = [...prevState.data];\n              axios({\n                method: \"put\",\n                url: \"\".concat(apiDashManage + \"product\"),\n                headers: {\n                  Authorization: \"Bearer \" + localStorage.getItem(\"token\")\n                },\n                data: {\n                  name: newData.name,\n                  price: newData.price,\n                  stock: newData.stock,\n                  description: newData.description,\n                  imgUrl: newData.imgUrl,\n                  categoryId: newData.categoryId,\n                  id: newData._id\n                }\n              }).then(res => {\n                console.log(\"EDIT DATA\", res);\n                Swal.fire(\"Update Success\", \"\", \"success\");\n                handleGetProduct();\n              });\n              return _objectSpread({}, prevState, {\n                data\n              });\n            });\n          }\n        }, 600);\n      }),\n      onRowDelete: oldData => new Promise(resolve => {\n        setTimeout(() => {\n          resolve();\n          setState(prevState => {\n            const data = [...prevState.data];\n            axios({\n              method: \"delete\",\n              url: \"\".concat(apiDashManage + \"\".concat(\"product/\" + oldData._id)),\n              headers: {\n                Authorization: \"Bearer \" + localStorage.getItem(\"token\")\n              },\n              data: oldData\n            }).then(res => {\n              console.log(\"Delete DATA\", res);\n              Swal.fire(\"Delete Success\", \"\", \"success\");\n              handleGetProduct();\n            });\n            return _objectSpread({}, prevState, {\n              data\n            });\n          });\n        }, 600);\n      })\n    },\n    options: {\n      headerStyle: {\n        fontSize: \"15px\",\n        fontWeight: \"bold\",\n        borderRight: \"1px solid #fff\",\n        background: \"#358A7C\",\n        color: \"#fff\"\n      },\n      rowStyle: {\n        fontFamily: \"Roboto,Helvetica,Arial,sans-serif\"\n      },\n      exportButton: true\n    },\n    detailPanel: rowData => {\n      return React.createElement(\"img\", {\n        style: {\n          width: \"25%\",\n          height: \"250px\",\n          display: \"block\",\n          marginLeft: \"auto\",\n          marginRight: \"auto\",\n          marginTop: \"10px\",\n          marginBottom: \"10px\"\n        },\n        src: \"https://images.unsplash.com/photo-1495231916356-a86217efff12?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=676&q=80\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      });\n    },\n    onRowClick: (event, rowData, togglePanel) => togglePanel(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  })));\n}","map":{"version":3,"sources":["/home/dimas/git/react-dashboard/src/views/Products/Products.js"],"names":["React","useState","useEffect","useContext","makeStyles","MaterialTable","CategoryContext","axios","apiDashManage","LoadingOverlay","Swal","useStyles","theme","root","padding","spacing","content","marginTop","Categeory","classes","categoryContext","setCategoryContext","dataCategory","setDataCategory","dataProduct","setDataProduct","id","setId","obj","reduce","acc","cur","i","_id","name","get","add","update","delete","loading","setLoading","columns","title","field","lookup","data","name_product","slug","price","stock","description","status","imageUrl","categoryId","state","setState","handleGetCategory","handleGetProduct","console","log","setFormState","method","url","headers","Authorization","localStorage","getItem","then","res","categories","products","map","rest","categoryName","onRowAdd","newData","Promise","resolve","setTimeout","prevState","fire","onRowUpdate","oldData","imgUrl","onRowDelete","headerStyle","fontSize","fontWeight","borderRight","background","color","rowStyle","fontFamily","exportButton","rowData","width","height","display","marginLeft","marginRight","marginBottom","event","togglePanel"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from \"react\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport MaterialTable from \"material-table\";\nimport { CategoryContext } from \"../../context/categoryContext\";\nimport axios from \"axios\";\nimport { apiDashManage } from \"../../api/api\";\nimport LoadingOverlay from \"react-loading-overlay\";\nimport Swal from \"sweetalert2\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    padding: theme.spacing(0.5),\n  },\n  content: {\n    marginTop: theme.spacing(0),\n  },\n}));\n\nexport default function Categeory() {\n  const classes = useStyles();\n  const [categoryContext, setCategoryContext] = useContext(CategoryContext);\n  const [dataCategory, setDataCategory] = useState([]);\n  const [dataProduct, setDataProduct] = useState([]);\n  const [id, setId] = useState(null);\n\n  var obj = categoryContext.reduce(function(acc, cur, i) {\n    acc[cur._id] = cur.name;\n    return acc;\n  }, {});\n\n  const [loading, setLoading] = useState({\n    get: false,\n    add: false,\n    update: false,\n    delete: false,\n  });\n  const [state, setState] = React.useState({\n    columns: [\n      { title: \"Name\", field: \"name\" },\n      { title: \"Price\", field: \"price\" },\n      { title: \"Stock\", field: \"stock\" },\n      { title: \"Description\", field: \"description\" },\n      { title: \"Image\", field: \"imageUrl\" },\n      {\n        title: \"Category\",\n        field: \"categoryId\",\n        lookup: obj,\n      },\n    ],\n    data: [\n      {\n        name_product: \"Daun\",\n        slug: \"Baran\",\n        price: \"Rp. 80.000\",\n        stock: \"sss\",\n        description: \"ddd\",\n        status: \"sac\",\n        imageUrl: \"laks\",\n        categoryId: \"uuuu\",\n      },\n      {\n        name_product: \"Daun\",\n        slug: \"Baran\",\n        price: \"Rp. 100.000\",\n        stock: \"sss\",\n        description: \"ddd\",\n        status: \"sac\",\n        imageUrl: \"laks\",\n        categoryId: \"uuuu\",\n      },\n      {\n        name_product: \"Daun\",\n        slug: \"Baran\",\n        price: \"Rp. 95.000\",\n        stock: \"sss\",\n        description: \"ddd\",\n        status: \"sac\",\n        imageUrl: \"laks\",\n        categoryId: \"uuuu\",\n      },\n      {\n        name_product: \"Daun\",\n        slug: \"Baran\",\n        price: \"Rp. 100.000\",\n        stock: \"sss\",\n        description: \"ddd\",\n        status: \"sac\",\n        imageUrl: \"laks\",\n        categoryId: \"uuuu\",\n      },\n    ],\n  });\n\n  useEffect(() => {\n    handleGetCategory();\n    handleGetProduct();\n  }, []);\n\n  useEffect(() => {\n    console.log(\"data categ\", dataCategory);\n  }, [dataCategory]);\n\n  const handleGetCategory = () => {\n    setFormState((loading) => ({\n      ...loading,\n      get: true,\n    }));\n    axios({\n      method: \"get\",\n      url: `${apiDashManage + \"category\"}`,\n      headers: {\n        Authorization: \"Bearer \" + localStorage.getItem(\"token\"),\n      },\n    }).then((res) => {\n      console.log(\"respon get category\", res.data.categories);\n      setDataCategory(res.data.categories);\n      setFormState((loading) => ({\n        ...loading,\n        get: false,\n      }));\n    });\n  };\n  const handleGetProduct = () => {\n    axios({\n      method: \"get\",\n      url: `${apiDashManage + \"product\"}`,\n      headers: {\n        Authorization: \"Bearer \" + localStorage.getItem(\"token\"),\n      },\n    }).then((res) => {\n      setDataProduct(res.data.products);\n    });\n  };\n\n  return (\n    <LoadingOverlay active={loading.get} spinner text=\"loading your data...\">\n      <div className={classes.root}>\n        <MaterialTable\n          className={classes.content}\n          title=\"Products\"\n          columns={state.columns}\n          data={dataProduct.map(({ categoryId, ...rest }) => {\n            return {\n              ...rest,\n              categoryId: categoryId._id,\n              categoryName: categoryId.name,\n            };\n          })}\n          editable={{\n            onRowAdd: (newData) =>\n              new Promise((resolve) => {\n                setTimeout(() => {\n                  resolve();\n                  setState((prevState) => {\n                    const data = [...prevState.data];\n                    axios({\n                      method: \"post\",\n                      url: `${apiDashManage + \"product\"}`,\n                      headers: {\n                        Authorization:\n                          \"Bearer \" + localStorage.getItem(\"token\"),\n                      },\n                      data: newData,\n                    }).then((res) => {\n                      console.log(\"ADD DATA\", res);\n                      Swal.fire(\"Added Success\", \"\", \"success\");\n                      // setLoading(loading.add(false));\n                      handleGetProduct();\n                    });\n                    return { ...prevState, data };\n                  });\n                }, 600);\n              }),\n            onRowUpdate: (newData, oldData) =>\n              new Promise((resolve) => {\n                setTimeout(() => {\n                  resolve();\n                  if (oldData) {\n                    setState((prevState) => {\n                      const data = [...prevState.data];\n                      axios({\n                        method: \"put\",\n                        url: `${apiDashManage + \"product\"}`,\n                        headers: {\n                          Authorization:\n                            \"Bearer \" + localStorage.getItem(\"token\"),\n                        },\n                        data: {\n                          name: newData.name,\n                          price: newData.price,\n                          stock: newData.stock,\n                          description: newData.description,\n                          imgUrl: newData.imgUrl,\n                          categoryId: newData.categoryId,\n                          id: newData._id,\n                        },\n                      }).then((res) => {\n                        console.log(\"EDIT DATA\", res);\n                        Swal.fire(\"Update Success\", \"\", \"success\");\n                        handleGetProduct();\n                      });\n                      return { ...prevState, data };\n                    });\n                  }\n                }, 600);\n              }),\n            onRowDelete: (oldData) =>\n              new Promise((resolve) => {\n                setTimeout(() => {\n                  resolve();\n                  setState((prevState) => {\n                    const data = [...prevState.data];\n                    axios({\n                      method: \"delete\",\n                      url: `${apiDashManage + `${\"product/\" + oldData._id}`}`,\n                      headers: {\n                        Authorization:\n                          \"Bearer \" + localStorage.getItem(\"token\"),\n                      },\n                      data: oldData,\n                    }).then((res) => {\n                      console.log(\"Delete DATA\", res);\n                      Swal.fire(\"Delete Success\", \"\", \"success\");\n                      handleGetProduct();\n                    });\n                    return { ...prevState, data };\n                  });\n                }, 600);\n              }),\n          }}\n          options={{\n            headerStyle: {\n              fontSize: \"15px\",\n              fontWeight: \"bold\",\n              borderRight: \"1px solid #fff\",\n              background: \"#358A7C\",\n              color: \"#fff\",\n            },\n            rowStyle: {\n              fontFamily: \"Roboto,Helvetica,Arial,sans-serif\",\n            },\n            exportButton: true,\n          }}\n          detailPanel={(rowData) => {\n            return (\n              <img\n                style={{\n                  width: \"25%\",\n                  height: \"250px\",\n                  display: \"block\",\n                  marginLeft: \"auto\",\n                  marginRight: \"auto\",\n                  marginTop: \"10px\",\n                  marginBottom: \"10px\",\n                }}\n                src=\"https://images.unsplash.com/photo-1495231916356-a86217efff12?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=676&q=80\"\n              />\n            );\n          }}\n          onRowClick={(event, rowData, togglePanel) => togglePanel()}\n        />\n      </div>\n    </LoadingOverlay>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}